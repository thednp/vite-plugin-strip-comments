{"version":3,"file":"index.mjs","sources":["../src/index.ts"],"sourcesContent":["export type StripCommentsOutput = {\n  name: string;\n  transform: (\n    text: string,\n    id: string | undefined,\n  ) => undefined | { code: string; map: string | null };\n};\n\n/**\n * @default 'istanbul'\n */\nexport type StripCommentsConfig = {\n  type: \"none\" | \"keep-legal\" | \"istanbul\";\n};\n\nconst replacements: Record<\"none\" | \"keep-legal\" | \"istanbul\", RegExp> = {\n  none: /((?=\\/\\*).*\\*\\/)|((?=((?<!\\:)\\/\\/)).*(?=\\n))/gm,\n  \"keep-legal\":\n    /(((?=(\\/\\*[\\s\\S](?!(\\@legal|\\@license)))).*\\*\\/)|((?=((?<!\\:)\\/\\/[\\s\\S](?!(\\@legal|\\@license)))).*(?=\\n)))/gm,\n  istanbul:\n    /(((?=(\\/\\*[\\s\\S]istanbul)).*\\*\\/)|((?=(\\/\\/[\\s\\S]istanbul)).*(?=\\n)))/gm,\n};\n\nconst stripComments = (cfg?: Partial<StripCommentsConfig>) => {\n  return {\n    name: \"vite-plugin-strip-comments\",\n    /* @ts-expect-error - it's just how Vite plugins work */\n    transform(code: string, id?: string) {\n      /* istanbul ignore else @preserve */\n      if (code?.length && (!id?.length || !id.includes(\"node_modules\"))) {\n        const replacement = [\"none\", \"legal\", \"istanbul\"].some((x) =>\n            cfg?.type === x\n          )\n          ? replacements[cfg?.type as StripCommentsConfig[\"type\"]]\n          : replacements[\"istanbul\"];\n        return {\n          code: code.replace(replacement, \"\"),\n          map: null,\n        };\n      }\n    },\n  } satisfies StripCommentsOutput;\n};\n\nexport default stripComments;\n"],"names":["replacements","stripComments","cfg","code","id","replacement","x"],"mappings":"AAeA,MAAMA,IAAmE;AAAA,EACvE,MAAM;AAAA,EACN,cACE;AAAA,EACF,UACE;AACJ,GAEMC,IAAgB,CAACC,OACd;AAAA,EACL,MAAM;AAAA;AAAA,EAEN,UAAUC,GAAcC,GAAa;AAE/B,QAAAD,GAAM,WAAW,CAACC,GAAI,UAAU,CAACA,EAAG,SAAS,cAAc,IAAI;AACjE,YAAMC,IAAc,CAAC,QAAQ,SAAS,UAAU,EAAE;AAAA,QAAK,CAACC,MACpDJ,GAAK,SAASI;AAAA,UAEdN,EAAaE,GAAK,IAAmC,IACrDF,EAAa;AACV,aAAA;AAAA,QACL,MAAMG,EAAK,QAAQE,GAAa,EAAE;AAAA,QAClC,KAAK;AAAA,MACP;AAAA,IAAA;AAAA,EACF;AAEJ;"}