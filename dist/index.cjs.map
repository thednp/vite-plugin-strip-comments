{"version":3,"file":"index.cjs","sources":["../src/index.ts"],"sourcesContent":["export type StripCommentsOutput = {\n  name: string;\n  transform: (\n    text: string,\n    id: string | undefined,\n  ) => undefined | { code: string; map: string | null };\n};\n\n/**\n * @default 'istanbul'\n */\nexport type StripCommentsConfig = {\n  type: \"none\" | \"keep-legal\" | \"istanbul\";\n};\n\nconst replacements: Record<\"none\" | \"keep-legal\" | \"istanbul\", RegExp> = {\n  none: /((?=\\/\\*).*\\*\\/)|((?=((?<!\\:)\\/\\/)).*(?=\\n))/gm,\n  \"keep-legal\":\n    /(((?=(\\/\\*[\\s\\S](?!(\\@legal|\\@license)))).*\\*\\/)|((?=((?<!\\:)\\/\\/[\\s\\S](?!(\\@legal|\\@license)))).*(?=\\n)))/gm,\n  istanbul:\n    /(((?=(\\/\\*[\\s\\S]istanbul)).*\\*\\/)|((?=(\\/\\/[\\s\\S]istanbul)).*(?=\\n)))/gm,\n};\n\nconst stripComments = (cfg?: Partial<StripCommentsConfig>) => {\n  return {\n    name: \"vite-plugin-strip-comments\",\n    /* @ts-expect-error - it's just how Vite plugins work */\n    transform(code: string, id?: string) {\n      /* istanbul ignore else @preserve */\n      if (code?.length && (!id?.length || !id.includes(\"node_modules\"))) {\n        const replacement = [\"none\", \"legal\", \"istanbul\"].some((x) =>\n            cfg?.type === x\n          )\n          ? replacements[cfg?.type as StripCommentsConfig[\"type\"]]\n          : replacements[\"istanbul\"];\n        return {\n          code: code.replace(replacement, \"\"),\n          map: null,\n        };\n      }\n    },\n  } satisfies StripCommentsOutput;\n};\n\nexport default stripComments;\n"],"names":["replacements","stripComments","cfg","code","id","replacement","x"],"mappings":"aAeA,MAAMA,EAAmE,CACvE,KAAM,iDACN,aACE,+GACF,SACE,yEACJ,EAEMC,EAAiBC,IACd,CACL,KAAM,6BAEN,UAAUC,EAAcC,EAAa,CAE/B,GAAAD,GAAM,SAAW,CAACC,GAAI,QAAU,CAACA,EAAG,SAAS,cAAc,GAAI,CACjE,MAAMC,EAAc,CAAC,OAAQ,QAAS,UAAU,EAAE,KAAMC,GACpDJ,GAAK,OAASI,GAEdN,EAAaE,GAAK,IAAmC,EACrDF,EAAa,SACV,MAAA,CACL,KAAMG,EAAK,QAAQE,EAAa,EAAE,EAClC,IAAK,IACP,CAAA,CACF,CAEJ"}